<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="theme-color" content="#000000">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="CrackScreen">
<meta name="description" content="The most realistic broken screen prank app of 2026">
<link rel="manifest" href="#" id="manifest-link">
<title>CrackScreen ‚Äì Fake Broken Screen Prank</title>

<style>
  /* ============================================================
     RESET & BASE
  ============================================================ */
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  :root {
    --neon-blue: #00d4ff;
    --neon-purple: #b300ff;
    --neon-pink: #ff0080;
    --neon-green: #00ff88;
    --glass-bg: rgba(255,255,255,0.06);
    --glass-border: rgba(255,255,255,0.12);
    --dark-bg: #050508;
    --card-bg: rgba(15,15,25,0.85);
    --text-primary: #ffffff;
    --text-secondary: rgba(255,255,255,0.55);
  }
  html, body {
    width: 100%; height: 100%;
    overflow: hidden;
    background: var(--dark-bg);
    color: var(--text-primary);
    font-family: 'SF Pro Display', -apple-system, 'Helvetica Neue', sans-serif;
    -webkit-tap-highlight-color: transparent;
    -webkit-user-select: none;
    user-select: none;
    touch-action: none;
  }

  /* ============================================================
     SCREENS LAYOUT
  ============================================================ */
  .screen {
    position: fixed; inset: 0;
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    transition: opacity 0.5s ease;
  }
  .screen.hidden { opacity: 0; pointer-events: none; }

  /* ============================================================
     SCREEN 1: LAUNCH / START PRANK
  ============================================================ */
  #screen-launch {
    background: radial-gradient(ellipse at 30% 20%, rgba(0,212,255,0.15) 0%, transparent 60%),
                radial-gradient(ellipse at 70% 80%, rgba(179,0,255,0.15) 0%, transparent 60%),
                radial-gradient(ellipse at 50% 50%, rgba(255,0,128,0.08) 0%, transparent 70%),
                #050508;
    overflow: hidden;
  }
  #screen-launch::before {
    content: '';
    position: absolute; inset: 0;
    background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,212,255,0.015) 2px, rgba(0,212,255,0.015) 4px);
    pointer-events: none;
  }

  /* Floating particles bg */
  .particle-field {
    position: absolute; inset: 0;
    overflow: hidden;
    pointer-events: none;
  }
  .particle {
    position: absolute;
    border-radius: 50%;
    animation: float-particle linear infinite;
    opacity: 0;
  }

  @keyframes float-particle {
    0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { transform: translateY(-20px) rotate(720deg); opacity: 0; }
  }

  .launch-content {
    position: relative; z-index: 2;
    display: flex; flex-direction: column;
    align-items: center; gap: 0;
    padding: 20px;
    width: 100%; max-width: 420px;
  }

  /* Cracked phone icon */
  .phone-icon-wrap {
    position: relative;
    width: 140px; height: 180px;
    margin-bottom: 32px;
    animation: phone-float 3s ease-in-out infinite;
  }
  @keyframes phone-float {
    0%, 100% { transform: translateY(0) rotate(-2deg); }
    50% { transform: translateY(-12px) rotate(2deg); }
  }
  .phone-icon-svg {
    width: 100%; height: 100%;
    filter: drop-shadow(0 0 30px rgba(0,212,255,0.4)) drop-shadow(0 0 60px rgba(179,0,255,0.2));
  }

  /* Glow ring */
  .glow-ring {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    width: 200px; height: 200px;
    border-radius: 50%;
    border: 1px solid rgba(0,212,255,0.3);
    animation: ring-pulse 2s ease-in-out infinite;
  }
  .glow-ring:nth-child(2) {
    width: 250px; height: 250px;
    animation-delay: 0.5s;
    border-color: rgba(179,0,255,0.2);
  }
  @keyframes ring-pulse {
    0%, 100% { opacity: 0.5; transform: translate(-50%,-50%) scale(1); }
    50% { opacity: 1; transform: translate(-50%,-50%) scale(1.05); }
  }

  .app-title {
    font-size: clamp(32px, 8vw, 48px);
    font-weight: 800;
    letter-spacing: -1px;
    text-align: center;
    background: linear-gradient(135deg, #fff 0%, var(--neon-blue) 50%, var(--neon-purple) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1.1;
    margin-bottom: 8px;
  }
  .app-subtitle {
    font-size: 14px;
    color: var(--text-secondary);
    letter-spacing: 3px;
    text-transform: uppercase;
    text-align: center;
    margin-bottom: 40px;
  }

  /* Stats row */
  .stats-row {
    display: flex; gap: 16px;
    margin-bottom: 40px;
    width: 100%;
  }
  .stat-card {
    flex: 1;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: 16px;
    padding: 14px 10px;
    text-align: center;
    backdrop-filter: blur(20px);
  }
  .stat-num {
    font-size: 22px;
    font-weight: 700;
    background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  .stat-label {
    font-size: 10px;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-top: 2px;
  }

  /* Start button */
  .btn-start {
    position: relative;
    width: 100%;
    padding: 20px;
    border: none;
    border-radius: 20px;
    background: linear-gradient(135deg, var(--neon-blue) 0%, var(--neon-purple) 100%);
    color: #fff;
    font-size: 18px;
    font-weight: 700;
    letter-spacing: 1px;
    text-transform: uppercase;
    cursor: pointer;
    overflow: hidden;
    transition: transform 0.15s ease, box-shadow 0.15s ease;
    box-shadow: 0 0 40px rgba(0,212,255,0.4), 0 0 80px rgba(179,0,255,0.2);
    margin-bottom: 16px;
  }
  .btn-start::before {
    content: '';
    position: absolute; inset: 0;
    background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, transparent 60%);
  }
  .btn-start::after {
    content: '';
    position: absolute; top: -50%; left: -60%;
    width: 40%; height: 200%;
    background: rgba(255,255,255,0.3);
    transform: skewX(-20deg);
    animation: btn-shine 3s ease-in-out infinite;
  }
  @keyframes btn-shine {
    0% { left: -60%; }
    30%, 100% { left: 150%; }
  }
  .btn-start:active { transform: scale(0.97); }
  .btn-start span { position: relative; z-index: 1; }

  /* Settings row */
  .settings-row {
    display: flex; gap: 12px; width: 100%;
  }
  .btn-setting {
    flex: 1;
    padding: 14px;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: 16px;
    color: var(--text-secondary);
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 1px;
    text-transform: uppercase;
    cursor: pointer;
    backdrop-filter: blur(20px);
    transition: all 0.2s;
    text-align: center;
  }
  .btn-setting:active { background: rgba(255,255,255,0.1); color: #fff; }
  .btn-setting .icon { font-size: 18px; display: block; margin-bottom: 4px; }

  /* Premium badge */
  .premium-badge {
    margin-top: 20px;
    padding: 8px 20px;
    background: linear-gradient(135deg, rgba(255,215,0,0.15), rgba(255,140,0,0.1));
    border: 1px solid rgba(255,215,0,0.3);
    border-radius: 20px;
    font-size: 12px;
    color: #ffd700;
    text-align: center;
    letter-spacing: 0.5px;
    cursor: pointer;
    transition: all 0.2s;
  }
  .premium-badge:active { background: rgba(255,215,0,0.2); }

  /* ============================================================
     SCREEN 2: COUNTDOWN
  ============================================================ */
  #screen-countdown {
    background: #000;
  }
  .countdown-inner {
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    gap: 16px;
  }
  .countdown-label {
    font-size: 14px;
    color: var(--text-secondary);
    letter-spacing: 4px;
    text-transform: uppercase;
  }
  .countdown-num {
    font-size: clamp(120px, 35vw, 200px);
    font-weight: 900;
    line-height: 1;
    background: linear-gradient(135deg, #fff 0%, var(--neon-blue) 60%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: cd-pulse 1s ease-in-out infinite;
    filter: drop-shadow(0 0 40px rgba(0,212,255,0.8));
  }
  @keyframes cd-pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }
  .countdown-hint {
    font-size: 13px;
    color: rgba(255,255,255,0.35);
    letter-spacing: 1px;
    text-align: center;
    padding: 0 30px;
  }

  /* ============================================================
     SCREEN 3: HOME SCREEN (FAKE PHONE)
  ============================================================ */
  #screen-home {
    background: #000;
    overflow: hidden;
    cursor: none;
  }

  /* Wallpaper */
  .wallpaper {
    position: absolute; inset: 0;
    background: 
      radial-gradient(ellipse at 20% 10%, rgba(100,180,255,0.5) 0%, transparent 40%),
      radial-gradient(ellipse at 80% 90%, rgba(200,100,255,0.4) 0%, transparent 40%),
      radial-gradient(ellipse at 50% 50%, rgba(255,100,150,0.2) 0%, transparent 60%),
      linear-gradient(160deg, #0a0a2e 0%, #1a0a3e 30%, #0d1a4e 60%, #0a2030 100%);
    z-index: 0;
  }
  /* Aurora effect */
  .wallpaper::after {
    content: '';
    position: absolute; inset: 0;
    background: 
      radial-gradient(ellipse at 30% 40%, rgba(0,200,255,0.15) 0%, transparent 50%),
      radial-gradient(ellipse at 70% 60%, rgba(180,0,255,0.12) 0%, transparent 50%);
    animation: aurora 8s ease-in-out infinite alternate;
  }
  @keyframes aurora {
    0% { opacity: 0.5; transform: scale(1); }
    100% { opacity: 1; transform: scale(1.1) rotate(3deg); }
  }

  /* Dynamic Island */
  .dynamic-island {
    position: absolute;
    top: 14px; left: 50%;
    transform: translateX(-50%);
    width: 126px; height: 37px;
    background: #000;
    border-radius: 20px;
    z-index: 100;
    display: flex; align-items: center; justify-content: center;
    gap: 8px;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 0 0 1px rgba(255,255,255,0.05);
  }
  .dynamic-island.expand {
    width: 240px; height: 50px;
    border-radius: 26px;
  }
  .di-camera {
    width: 10px; height: 10px;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, rgba(100,100,100,0.8), #111);
    box-shadow: inset 0 0 4px rgba(0,200,255,0.3);
  }
  .di-speaker {
    width: 48px; height: 6px;
    background: #1a1a1a;
    border-radius: 3px;
  }

  /* Status bar */
  .status-bar {
    position: absolute;
    top: 18px; left: 0; right: 0;
    height: 44px;
    display: flex; align-items: center;
    padding: 0 24px;
    z-index: 90;
  }
  .status-time {
    font-size: 16px;
    font-weight: 600;
    letter-spacing: -0.3px;
    color: #fff;
  }
  .status-icons {
    margin-left: auto;
    display: flex; align-items: center;
    gap: 6px;
  }
  .status-icon {
    color: #fff;
    font-size: 13px;
  }
  /* Battery */
  .battery {
    display: flex; align-items: center;
    gap: 2px;
  }
  .battery-body {
    width: 24px; height: 12px;
    border: 1.5px solid rgba(255,255,255,0.8);
    border-radius: 3px;
    padding: 1.5px;
    position: relative;
  }
  .battery-body::after {
    content: '';
    position: absolute; right: -5px; top: 50%;
    transform: translateY(-50%);
    width: 3px; height: 5px;
    background: rgba(255,255,255,0.6);
    border-radius: 0 1px 1px 0;
  }
  .battery-fill {
    height: 100%; width: 75%;
    background: #5afc00;
    border-radius: 1px;
  }

  /* Lock screen clock */
  .lock-clock {
    position: absolute;
    top: 25%;
    left: 0; right: 0;
    display: flex; flex-direction: column;
    align-items: center;
    z-index: 10;
  }
  .lock-time {
    font-size: clamp(64px, 18vw, 88px);
    font-weight: 100;
    letter-spacing: -4px;
    line-height: 1;
    color: rgba(255,255,255,0.95);
    text-shadow: 0 0 40px rgba(255,255,255,0.3);
  }
  .lock-date {
    font-size: 16px;
    color: rgba(255,255,255,0.75);
    font-weight: 400;
    margin-top: 4px;
    letter-spacing: 0.3px;
  }

  /* Weather widget */
  .weather-widget {
    position: absolute;
    top: 52%;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(30px);
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 20px;
    padding: 16px 24px;
    display: flex; align-items: center;
    gap: 12px;
    z-index: 10;
    min-width: 200px;
  }
  .weather-icon { font-size: 36px; }
  .weather-info {}
  .weather-temp {
    font-size: 28px;
    font-weight: 300;
    color: #fff;
    line-height: 1;
  }
  .weather-cond {
    font-size: 12px;
    color: rgba(255,255,255,0.6);
    margin-top: 2px;
  }

  /* Notification */
  .notif-stack {
    position: absolute;
    bottom: 160px;
    left: 20px; right: 20px;
    z-index: 10;
    display: flex; flex-direction: column;
    gap: 8px;
  }
  .notif-card {
    background: rgba(30,30,40,0.75);
    backdrop-filter: blur(40px);
    border: 1px solid rgba(255,255,255,0.12);
    border-radius: 16px;
    padding: 12px 14px;
    display: flex; align-items: center;
    gap: 10px;
    animation: notif-slide 0.5s cubic-bezier(0.34,1.56,0.64,1) both;
  }
  .notif-card:nth-child(2) { animation-delay: 0.1s; }
  @keyframes notif-slide {
    from { transform: translateY(20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }
  .notif-app-icon {
    width: 36px; height: 36px;
    border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    font-size: 20px;
    flex-shrink: 0;
  }
  .notif-content {}
  .notif-app { font-size: 11px; color: rgba(255,255,255,0.5); font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
  .notif-title { font-size: 13px; color: #fff; font-weight: 600; }
  .notif-body { font-size: 12px; color: rgba(255,255,255,0.55); }
  .notif-time { margin-left: auto; font-size: 11px; color: rgba(255,255,255,0.35); flex-shrink: 0; }

  /* Home indicator */
  .home-indicator {
    position: absolute;
    bottom: 8px; left: 50%;
    transform: translateX(-50%);
    width: 134px; height: 5px;
    background: rgba(255,255,255,0.3);
    border-radius: 3px;
    z-index: 100;
  }

  /* Tap hint */
  .tap-hint {
    position: absolute;
    bottom: 30px; left: 0; right: 0;
    text-align: center;
    font-size: 13px;
    color: rgba(255,255,255,0.4);
    letter-spacing: 2px;
    text-transform: uppercase;
    animation: hint-pulse 2s ease-in-out infinite;
    z-index: 10;
  }
  @keyframes hint-pulse {
    0%, 100% { opacity: 0.4; }
    50% { opacity: 0.9; }
  }

  /* ============================================================
     SCREEN 4: CRACKED SCREEN
  ============================================================ */
  #screen-crack {
    background: #000;
    overflow: hidden;
    cursor: crosshair;
  }

  /* The glass canvas fills screen */
  #crack-canvas {
    position: absolute; inset: 0;
    width: 100%; height: 100%;
    z-index: 50;
    pointer-events: none;
  }

  /* Background phone screenshot clone */
  .crack-bg {
    position: absolute; inset: 0;
    z-index: 1;
    background: 
      radial-gradient(ellipse at 20% 10%, rgba(100,180,255,0.5) 0%, transparent 40%),
      radial-gradient(ellipse at 80% 90%, rgba(200,100,255,0.4) 0%, transparent 40%),
      linear-gradient(160deg, #0a0a2e 0%, #1a0a3e 30%, #0d1a4e 60%, #0a2030 100%);
    filter: blur(0px);
    transition: filter 0.3s;
  }
  .crack-bg.distort { filter: blur(2px) brightness(0.7); }

  /* Crack overlay canvas interacts with touches */
  #crack-canvas { pointer-events: none; }

  /* Instruction overlay */
  .crack-instructions {
    position: absolute;
    bottom: 60px; left: 0; right: 0;
    text-align: center;
    z-index: 200;
    padding: 0 20px;
    transition: opacity 1s ease;
  }
  .crack-instructions.fade-out { opacity: 0; pointer-events: none; }
  .crack-inst-inner {
    display: inline-flex; flex-direction: column;
    gap: 6px;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 16px;
    padding: 14px 20px;
  }
  .crack-inst-item {
    font-size: 12px;
    color: rgba(255,255,255,0.7);
    display: flex; align-items: center; gap: 8px;
  }
  .crack-inst-item .badge {
    background: rgba(255,255,255,0.1);
    border-radius: 6px;
    padding: 2px 8px;
    font-size: 11px;
    font-weight: 600;
    color: var(--neon-blue);
    white-space: nowrap;
  }

  /* Share button */
  .btn-share {
    position: absolute;
    bottom: 20px; right: 20px;
    z-index: 300;
    background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
    border: none;
    border-radius: 50%;
    width: 52px; height: 52px;
    display: flex; align-items: center; justify-content: center;
    font-size: 22px;
    cursor: pointer;
    box-shadow: 0 0 20px rgba(0,212,255,0.4);
    transition: transform 0.15s;
  }
  .btn-share:active { transform: scale(0.9); }

  /* Reset button */
  .btn-reset {
    position: absolute;
    bottom: 20px; left: 20px;
    z-index: 300;
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 50%;
    width: 52px; height: 52px;
    display: flex; align-items: center; justify-content: center;
    font-size: 22px;
    cursor: pointer;
    backdrop-filter: blur(20px);
    transition: transform 0.15s;
  }
  .btn-reset:active { transform: scale(0.9); }

  /* ============================================================
     SCREEN 5: BOOT / RESTART ANIMATION
  ============================================================ */
  #screen-boot {
    background: #000;
    align-items: center;
    justify-content: center;
  }
  .boot-logo {
    font-size: 80px;
    filter: drop-shadow(0 0 30px rgba(255,255,255,0.5));
    animation: boot-fade 0.5s ease-out;
  }
  @keyframes boot-fade {
    from { opacity: 0; transform: scale(0.5); }
    to { opacity: 1; transform: scale(1); }
  }
  .boot-bar-wrap {
    margin-top: 30px;
    width: 120px; height: 3px;
    background: rgba(255,255,255,0.15);
    border-radius: 2px;
    overflow: hidden;
  }
  .boot-bar-fill {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
    border-radius: 2px;
    animation: boot-progress 2.5s ease-in-out forwards;
  }
  @keyframes boot-progress {
    0% { width: 0%; }
    30% { width: 35%; }
    60% { width: 60%; }
    80% { width: 80%; }
    100% { width: 100%; }
  }
  .boot-version {
    margin-top: 12px;
    font-size: 11px;
    color: rgba(255,255,255,0.3);
    letter-spacing: 2px;
  }

  /* ============================================================
     PRESS HARDER OVERLAY
  ============================================================ */
  .press-harder {
    position: absolute;
    inset: 0;
    display: flex; align-items: center; justify-content: center;
    z-index: 400;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s;
  }
  .press-harder.show { opacity: 1; }
  .press-harder-text {
    font-size: clamp(28px, 8vw, 48px);
    font-weight: 900;
    color: #fff;
    text-transform: uppercase;
    letter-spacing: 3px;
    text-shadow: 0 0 30px rgba(255,0,0,0.8), 0 0 60px rgba(255,0,0,0.4);
    animation: ph-shake 0.1s infinite;
  }
  @keyframes ph-shake {
    0%, 100% { transform: translate(0,0) rotate(0deg); }
    25% { transform: translate(-2px, 1px) rotate(-0.5deg); }
    75% { transform: translate(2px, -1px) rotate(0.5deg); }
  }

  /* ============================================================
     SCREEN SHAKE
  ============================================================ */
  .shake {
    animation: screen-shake 0.5s cubic-bezier(0.36,0.07,0.19,0.97) both;
  }
  @keyframes screen-shake {
    10%, 90% { transform: translate(-3px, 0); }
    20%, 80% { transform: translate(5px, -2px); }
    30%, 50%, 70% { transform: translate(-5px, 2px); }
    40%, 60% { transform: translate(5px, 0); }
    100% { transform: translate(0, 0); }
  }

  /* ============================================================
     BANNER AD (placeholder)
  ============================================================ */
  .ad-banner {
    position: fixed;
    bottom: 0; left: 0; right: 0;
    height: 50px;
    background: rgba(0,0,0,0.8);
    border-top: 1px solid rgba(255,255,255,0.08);
    display: flex; align-items: center; justify-content: center;
    z-index: 500;
    font-size: 11px;
    color: rgba(255,255,255,0.25);
    letter-spacing: 1px;
    text-transform: uppercase;
    display: none; /* hidden by default, show on launch screen */
  }

  /* ============================================================
     MODAL: PREMIUM CRACK STYLES
  ============================================================ */
  .modal-overlay {
    position: fixed; inset: 0;
    background: rgba(0,0,0,0.8);
    backdrop-filter: blur(20px);
    z-index: 1000;
    display: flex; align-items: flex-end;
    padding: 20px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
  }
  .modal-overlay.show { opacity: 1; pointer-events: all; }
  .modal-sheet {
    width: 100%;
    background: linear-gradient(180deg, rgba(20,20,35,0.98), rgba(10,10,20,0.98));
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 28px 28px 0 0;
    padding: 24px 20px 40px;
    transform: translateY(100%);
    transition: transform 0.4s cubic-bezier(0.34,1.56,0.64,1);
  }
  .modal-overlay.show .modal-sheet { transform: translateY(0); }
  .modal-handle {
    width: 40px; height: 4px;
    background: rgba(255,255,255,0.2);
    border-radius: 2px;
    margin: 0 auto 20px;
  }
  .modal-title {
    font-size: 22px; font-weight: 700;
    text-align: center; margin-bottom: 6px;
    background: linear-gradient(135deg, #ffd700, #ff8c00);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  .modal-sub {
    font-size: 13px; color: rgba(255,255,255,0.5);
    text-align: center; margin-bottom: 24px;
  }
  .crack-styles-grid {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 12px; margin-bottom: 20px;
  }
  .crack-style-card {
    border-radius: 16px;
    padding: 16px 12px;
    text-align: center;
    cursor: pointer;
    border: 2px solid transparent;
    transition: all 0.2s;
    position: relative;
    overflow: hidden;
  }
  .crack-style-card.active { border-color: var(--neon-blue); }
  .crack-style-card.locked::after {
    content: 'üîí';
    position: absolute; top: 8px; right: 8px;
    font-size: 14px;
  }
  .cs-1 { background: linear-gradient(135deg, #1a1a2e, #16213e); }
  .cs-2 { background: linear-gradient(135deg, #0d0d1a, rgba(0,255,150,0.1)); }
  .cs-3 { background: linear-gradient(135deg, #1a0d1a, rgba(255,0,200,0.15)); }
  .cs-4 { background: linear-gradient(135deg, #1a0a0a, rgba(255,50,50,0.15)); }
  .cs-name { font-size: 13px; font-weight: 700; color: #fff; }
  .cs-price { font-size: 11px; color: rgba(255,255,255,0.4); margin-top: 2px; }
  .cs-preview { font-size: 28px; margin-bottom: 6px; }
  .btn-purchase-all {
    width: 100%;
    padding: 16px;
    background: linear-gradient(135deg, #ffd700, #ff8c00);
    border: none; border-radius: 16px;
    color: #000; font-size: 15px; font-weight: 800;
    letter-spacing: 0.5px;
    cursor: pointer;
    margin-bottom: 10px;
  }
  .btn-no-ads {
    width: 100%;
    padding: 14px;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: 16px;
    color: rgba(255,255,255,0.6);
    font-size: 13px;
    cursor: pointer;
    text-align: center;
  }
  .btn-modal-close {
    position: absolute; top: 20px; right: 20px;
    background: rgba(255,255,255,0.1);
    border: none; border-radius: 50%;
    width: 32px; height: 32px;
    color: rgba(255,255,255,0.5);
    font-size: 16px;
    cursor: pointer;
    display: flex; align-items: center; justify-content: center;
  }

  /* ============================================================
     SHARE OVERLAY
  ============================================================ */
  .share-overlay {
    position: fixed; inset: 0;
    background: rgba(0,0,0,0.9);
    z-index: 800;
    display: flex; align-items: center; justify-content: center;
    flex-direction: column;
    gap: 16px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
    padding: 20px;
  }
  .share-overlay.show { opacity: 1; pointer-events: all; }
  .share-card {
    background: linear-gradient(160deg, #0a0a2e, #1a0a3e);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 20px;
    padding: 20px;
    width: 100%; max-width: 320px;
    text-align: center;
  }
  .share-meme-text {
    font-size: 16px; font-weight: 700;
    color: var(--neon-blue);
    margin-bottom: 8px;
    text-shadow: 0 0 20px rgba(0,212,255,0.5);
  }
  .share-sub { font-size: 12px; color: rgba(255,255,255,0.4); }
  .share-actions { display: flex; gap: 10px; width: 100%; max-width: 320px; }
  .btn-share-platform {
    flex: 1; padding: 12px;
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 14px;
    background: rgba(255,255,255,0.05);
    color: #fff; font-size: 13px; font-weight: 600;
    cursor: pointer; text-align: center;
    transition: all 0.2s;
  }
  .btn-share-platform:active { background: rgba(255,255,255,0.12); }
  .btn-share-close {
    padding: 12px 24px;
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 14px;
    color: rgba(255,255,255,0.5);
    font-size: 13px;
    cursor: pointer;
  }

  /* ============================================================
     INTERSTITIAL AD
  ============================================================ */
  .interstitial-overlay {
    position: fixed; inset: 0;
    background: rgba(0,0,0,0.95);
    z-index: 900;
    display: flex; align-items: center; justify-content: center;
    flex-direction: column;
    gap: 16px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
    padding: 30px;
  }
  .interstitial-overlay.show { opacity: 1; pointer-events: all; }
  .interstitial-inner {
    background: linear-gradient(135deg, #111120, #1a1a30);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 24px;
    padding: 30px 24px;
    width: 100%; max-width: 360px;
    text-align: center;
  }
  .inter-tag { font-size: 10px; color: rgba(255,255,255,0.25); letter-spacing: 2px; text-transform: uppercase; margin-bottom: 16px; }
  .inter-title { font-size: 22px; font-weight: 800; margin-bottom: 8px; }
  .inter-sub { font-size: 13px; color: rgba(255,255,255,0.5); margin-bottom: 24px; }
  .inter-btn-skip {
    padding: 14px 32px;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: 14px;
    color: rgba(255,255,255,0.6);
    font-size: 13px;
    cursor: pointer;
    margin-top: 8px;
  }
  .inter-btn-action {
    width: 100%;
    padding: 16px;
    background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
    border: none; border-radius: 16px;
    color: #fff; font-size: 15px; font-weight: 700;
    cursor: pointer;
  }
  .inter-countdown { font-size: 12px; color: rgba(255,255,255,0.3); margin-top: 8px; }

  /* ============================================================
     GLASS SHARD PARTICLE
  ============================================================ */
  .glass-shard {
    position: absolute;
    pointer-events: none;
    z-index: 200;
    opacity: 1;
    animation: shard-fly var(--dur, 0.8s) ease-out forwards;
    transform-origin: center;
    will-change: transform, opacity;
  }
  @keyframes shard-fly {
    0% { transform: translate(0, 0) rotate(0deg) scale(1); opacity: 0.9; }
    100% { transform: translate(var(--tx, 0px), var(--ty, 60px)) rotate(var(--rot, 180deg)) scale(0.1); opacity: 0; }
  }

  /* Screen flash */
  .flash-overlay {
    position: fixed; inset: 0;
    background: rgba(255,255,255,0.95);
    z-index: 600;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.05s;
  }
  .flash-overlay.flash { animation: flash-anim 0.3s ease-out; }
  @keyframes flash-anim {
    0% { opacity: 1; }
    100% { opacity: 0; }
  }

  /* Loading dots */
  .loading-dots {
    display: flex; gap: 6px;
    justify-content: center;
    margin-top: 16px;
  }
  .loading-dot {
    width: 6px; height: 6px;
    border-radius: 50%;
    background: var(--neon-blue);
    animation: dot-pulse 1.4s ease-in-out infinite;
  }
  .loading-dot:nth-child(2) { animation-delay: 0.2s; }
  .loading-dot:nth-child(3) { animation-delay: 0.4s; }
  @keyframes dot-pulse {
    0%, 80%, 100% { transform: scale(0.6); opacity: 0.4; }
    40% { transform: scale(1); opacity: 1; }
  }

  /* Crack ripple effect */
  .crack-ripple {
    position: absolute;
    border-radius: 50%;
    border: 2px solid rgba(255,255,255,0.6);
    pointer-events: none;
    z-index: 300;
    animation: ripple-expand 0.6s ease-out forwards;
  }
  @keyframes ripple-expand {
    0% { width: 0; height: 0; opacity: 1; transform: translate(-50%, -50%); }
    100% { width: 100px; height: 100px; opacity: 0; transform: translate(-50%, -50%); }
  }

  /* Promo chip */
  .promo-chip {
    display: inline-flex; align-items: center; gap: 4px;
    background: rgba(0,255,136,0.1);
    border: 1px solid rgba(0,255,136,0.2);
    border-radius: 20px;
    padding: 4px 12px;
    font-size: 11px; color: #00ff88;
    margin-bottom: 16px;
    letter-spacing: 0.5px;
  }
</style>
</head>
<body>

<!-- ===================== SCREEN 1: LAUNCH ===================== -->
<div id="screen-launch" class="screen">
  <div class="particle-field" id="particles"></div>

  <div class="launch-content">
    <!-- Glow rings -->
    <div style="position:relative; display:flex; align-items:center; justify-content:center; margin-bottom:32px;">
      <div class="glow-ring"></div>
      <div class="glow-ring"></div>
      <!-- Phone SVG -->
      <div class="phone-icon-wrap" style="margin-bottom:0;">
        <svg class="phone-icon-svg" viewBox="0 0 140 180" fill="none" xmlns="http://www.w3.org/2000/svg">
          <!-- Phone body -->
          <rect x="8" y="4" width="124" height="172" rx="22" fill="url(#phoneGrad)" stroke="rgba(255,255,255,0.2)" stroke-width="1.5"/>
          <!-- Screen -->
          <rect x="14" y="20" width="112" height="148" rx="10" fill="url(#screenGrad)"/>
          <!-- Dynamic island -->
          <rect x="52" y="26" width="36" height="12" rx="6" fill="rgba(0,0,0,0.8)"/>
          <!-- Crack lines -->
          <line x1="70" y1="40" x2="30" y2="80" stroke="rgba(255,255,255,0.9)" stroke-width="1.5"/>
          <line x1="70" y1="40" x2="110" y2="90" stroke="rgba(255,255,255,0.9)" stroke-width="1.5"/>
          <line x1="30" y1="80" x2="10" y2="130" stroke="rgba(255,255,255,0.7)" stroke-width="1"/>
          <line x1="110" y1="90" x2="130" y2="140" stroke="rgba(255,255,255,0.7)" stroke-width="1"/>
          <line x1="70" y1="40" x2="80" y2="160" stroke="rgba(255,255,255,0.5)" stroke-width="0.8"/>
          <line x1="30" y1="80" x2="100" y2="130" stroke="rgba(255,255,255,0.6)" stroke-width="0.8"/>
          <line x1="50" y1="100" x2="20" y2="150" stroke="rgba(255,255,255,0.4)" stroke-width="0.7"/>
          <line x1="90" y1="60" x2="130" y2="100" stroke="rgba(255,255,255,0.5)" stroke-width="0.7"/>
          <!-- Impact point glow -->
          <circle cx="70" cy="40" r="6" fill="rgba(255,255,255,0.15)"/>
          <circle cx="70" cy="40" r="3" fill="rgba(255,255,255,0.4)"/>
          <!-- Side buttons -->
          <rect x="132" y="50" width="5" height="20" rx="2.5" fill="rgba(255,255,255,0.2)"/>
          <rect x="132" y="76" width="5" height="20" rx="2.5" fill="rgba(255,255,255,0.2)"/>
          <rect x="3" y="60" width="5" height="14" rx="2.5" fill="rgba(255,255,255,0.2)"/>
          <defs>
            <linearGradient id="phoneGrad" x1="0" y1="0" x2="140" y2="180" gradientUnits="userSpaceOnUse">
              <stop offset="0%" stop-color="#2a2a3e"/>
              <stop offset="100%" stop-color="#1a1a2e"/>
            </linearGradient>
            <linearGradient id="screenGrad" x1="14" y1="20" x2="126" y2="168" gradientUnits="userSpaceOnUse">
              <stop offset="0%" stop-color="#1e1e3f"/>
              <stop offset="50%" stop-color="#0d1a4e"/>
              <stop offset="100%" stop-color="#0a1530"/>
            </linearGradient>
          </defs>
        </svg>
      </div>
    </div>

    <div class="promo-chip">‚ö° 50M+ Pranks Pulled</div>
    <h1 class="app-title">CrackScreen</h1>
    <p class="app-subtitle">Fake Broken Screen ¬∑ 2026</p>

    <!-- Stats -->
    <div class="stats-row">
      <div class="stat-card">
        <div class="stat-num">4.9‚òÖ</div>
        <div class="stat-label">Rating</div>
      </div>
      <div class="stat-card">
        <div class="stat-num">50M+</div>
        <div class="stat-label">Downloads</div>
      </div>
      <div class="stat-card">
        <div class="stat-num">#1</div>
        <div class="stat-label">Prank App</div>
      </div>
    </div>

    <button class="btn-start" id="btn-start" onclick="startCountdown()">
      <span>üí• Start Prank</span>
    </button>

    <div class="settings-row">
      <button class="btn-setting" onclick="openModal()">
        <span class="icon">üíé</span>Crack Styles
      </button>
      <button class="btn-setting" id="install-btn" onclick="installPWA()" style="display:none;">
        <span class="icon">üì≤</span>Install App
      </button>
      <button class="btn-setting" onclick="showSettings()">
        <span class="icon">‚öôÔ∏è</span>Settings
      </button>
    </div>

    <div class="premium-badge" onclick="openModal()">
      üëë Go Premium ‚Äî Remove Ads Forever ¬∑ $1.99
    </div>
  </div>
</div>

<!-- ===================== SCREEN 2: COUNTDOWN ===================== -->
<div id="screen-countdown" class="screen hidden">
  <div class="countdown-inner">
    <div class="countdown-label">Prank starts in</div>
    <div class="countdown-num" id="countdown-num">3</div>
    <div class="countdown-hint">Hold phone out to your friend<br>then let them tap the screen!</div>
    <div class="loading-dots">
      <div class="loading-dot"></div>
      <div class="loading-dot"></div>
      <div class="loading-dot"></div>
    </div>
  </div>
</div>

<!-- ===================== SCREEN 3: HOME ===================== -->
<div id="screen-home" class="screen hidden" onclick="goToCrackFromHome()">
  <div class="wallpaper"></div>

  <!-- Dynamic Island -->
  <div class="dynamic-island">
    <div class="di-speaker"></div>
    <div class="di-camera"></div>
  </div>

  <!-- Status bar -->
  <div class="status-bar">
    <div class="status-time" id="status-time">9:41</div>
    <div class="status-icons">
      <span class="status-icon">‚ñ≤‚ñ≤‚ñ≤</span>
      <span class="status-icon">WiFi</span>
      <div class="battery">
        <div class="battery-body"><div class="battery-fill"></div></div>
      </div>
    </div>
  </div>

  <!-- Lock clock -->
  <div class="lock-clock">
    <div class="lock-time" id="lock-time">9:41</div>
    <div class="lock-date" id="lock-date">Monday, February 23</div>
  </div>

  <!-- Weather widget -->
  <div class="weather-widget">
    <div class="weather-icon">‚õÖ</div>
    <div class="weather-info">
      <div class="weather-temp">22¬∞</div>
      <div class="weather-cond">Partly Cloudy</div>
    </div>
  </div>

  <!-- Notifications -->
  <div class="notif-stack">
    <div class="notif-card">
      <div class="notif-app-icon" style="background:linear-gradient(135deg,#1da1f2,#0d8ecf)">üí¨</div>
      <div class="notif-content">
        <div class="notif-app">Messages</div>
        <div class="notif-title">Sarah üåü</div>
        <div class="notif-body">haha no way you have to see this üòÇ</div>
      </div>
      <div class="notif-time">now</div>
    </div>
    <div class="notif-card">
      <div class="notif-app-icon" style="background:linear-gradient(135deg,#ee2a7b,#f77737)">üì∏</div>
      <div class="notif-content">
        <div class="notif-app">Instagram</div>
        <div class="notif-title">12 people liked your photo</div>
        <div class="notif-body">@mike.dev and 11 others</div>
      </div>
      <div class="notif-time">2m</div>
    </div>
  </div>

  <!-- Tap hint -->
  <div class="tap-hint">Tap to unlock</div>

  <!-- Home indicator -->
  <div class="home-indicator"></div>
</div>

<!-- ===================== SCREEN 4: CRACKED ===================== -->
<div id="screen-crack" class="screen hidden">
  <div class="crack-bg" id="crack-bg"></div>

  <!-- Same lock-screen elements underneath -->
  <div class="dynamic-island" style="z-index:55; pointer-events:none;">
    <div class="di-speaker"></div>
    <div class="di-camera"></div>
  </div>
  <div class="status-bar" style="z-index:55; pointer-events:none;">
    <div class="status-time" id="crack-status-time">9:41</div>
    <div class="status-icons">
      <span class="status-icon">‚ñ≤‚ñ≤‚ñ≤</span>
      <span class="status-icon">WiFi</span>
      <div class="battery">
        <div class="battery-body"><div class="battery-fill"></div></div>
      </div>
    </div>
  </div>
  <div class="lock-clock" style="z-index:55; pointer-events:none;">
    <div class="lock-time" id="crack-lock-time">9:41</div>
    <div class="lock-date" id="crack-lock-date">Monday, February 23</div>
  </div>

  <!-- Crack canvas -->
  <canvas id="crack-canvas"></canvas>

  <!-- Press harder overlay -->
  <div class="press-harder" id="press-harder">
    <div class="press-harder-text">PRESS HARDER</div>
  </div>

  <!-- Instructions -->
  <div class="crack-instructions" id="crack-instructions">
    <div class="crack-inst-inner">
      <div class="crack-inst-item"><span class="badge">Tap</span> Crack glass</div>
      <div class="crack-inst-item"><span class="badge">Hold</span> Press harder</div>
      <div class="crack-inst-item"><span class="badge">Shake</span> Shatter!</div>
      <div class="crack-inst-item"><span class="badge">2x Tap</span> Reboot</div>
    </div>
  </div>

  <!-- Action buttons -->
  <button class="btn-share" onclick="showShare()" title="Share">üì§</button>
  <button class="btn-reset" onclick="resetPrank()" title="Reset">üîÑ</button>
</div>

<!-- ===================== SCREEN 5: BOOT ===================== -->
<div id="screen-boot" class="screen hidden">
  <div class="boot-logo">üçé</div>
  <div class="boot-bar-wrap">
    <div class="boot-bar-fill" id="boot-bar"></div>
  </div>
  <div class="boot-version">iOS 19.2 ‚Ä¢ CrackOS</div>
</div>

<!-- ===================== FLASH OVERLAY ===================== -->
<div class="flash-overlay" id="flash-overlay"></div>

<!-- ===================== PRESS HARDER is in screen-crack ===================== -->

<!-- ===================== MODAL: CRACK STYLES ===================== -->
<div class="modal-overlay" id="modal-styles" onclick="handleModalClick(event)">
  <div class="modal-sheet">
    <button class="btn-modal-close" onclick="closeModal()">‚úï</button>
    <div class="modal-handle"></div>
    <div class="modal-title">üíé Crack Style Pack</div>
    <div class="modal-sub">Choose your glass personality</div>
    <div class="crack-styles-grid">
      <div class="crack-style-card cs-1 active" onclick="selectStyle(0, this)">
        <div class="cs-preview">üî≤</div>
        <div class="cs-name">Classic</div>
        <div class="cs-price">Free</div>
      </div>
      <div class="crack-style-card cs-2 locked" onclick="selectStyle(1, this)">
        <div class="cs-preview">üíö</div>
        <div class="cs-name">Neon Matrix</div>
        <div class="cs-price">$0.99</div>
      </div>
      <div class="crack-style-card cs-3 locked" onclick="selectStyle(2, this)">
        <div class="cs-preview">ü©∏</div>
        <div class="cs-name">Blood Glass</div>
        <div class="cs-price">$0.99</div>
      </div>
      <div class="crack-style-card cs-4 locked" onclick="selectStyle(3, this)">
        <div class="cs-preview">üåà</div>
        <div class="cs-name">Holographic</div>
        <div class="cs-price">$1.99</div>
      </div>
    </div>
    <button class="btn-purchase-all" onclick="purchaseAll()">üëë Get All Styles ‚Äî $2.99</button>
    <button class="btn-no-ads" onclick="purchaseNoAds()">Remove Ads Forever ‚Äî $1.99</button>
  </div>
</div>

<!-- ===================== SHARE OVERLAY ===================== -->
<div class="share-overlay" id="share-overlay">
  <div class="share-card">
    <div style="font-size:48px; margin-bottom:12px;">üí•</div>
    <div class="share-meme-text">"My friend literally dropped<br>my phone!! üò±üò≠"</div>
    <div class="share-sub">CrackScreen App ¬∑ The #1 Prank of 2026</div>
  </div>
  <div class="share-actions">
    <button class="btn-share-platform" onclick="nativeShare()">üì§ Share</button>
    <button class="btn-share-platform" onclick="copyLink()">üîó Copy</button>
  </div>
  <button class="btn-share-close" onclick="hideShare()">Close</button>
</div>

<!-- ===================== INTERSTITIAL ===================== -->
<div class="interstitial-overlay" id="interstitial">
  <div class="interstitial-inner">
    <div class="inter-tag">Sponsored</div>
    <div class="inter-title" style="background:linear-gradient(135deg,var(--neon-blue),var(--neon-purple)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;">
      Upgrade to Premium
    </div>
    <div class="inter-sub">Remove all ads & unlock 4 exclusive crack styles for one-time $2.99</div>
    <button class="inter-btn-action" onclick="purchaseAll()">Unlock Everything ‚Äî $2.99</button>
    <button class="inter-btn-skip" id="inter-skip" onclick="closeInterstitial()">Skip (5)</button>
  </div>
</div>

<!-- ===================== AUDIO CONTEXT (inline) ===================== -->
<script>
/* ============================================================
   AUDIO ENGINE ‚Äî Procedural sounds via Web Audio API
============================================================ */
let audioCtx = null;

function getAudioCtx() {
  if (!audioCtx) {
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  }
  if (audioCtx.state === 'suspended') audioCtx.resume();
  return audioCtx;
}

function playCrackSound(intensity = 1) {
  try {
    const ctx = getAudioCtx();
    const duration = 0.15 + intensity * 0.1;
    const gain = ctx.createGain();
    gain.gain.setValueAtTime(0.8 * intensity, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + duration);
    gain.connect(ctx.destination);

    // White noise burst
    const bufferSize = ctx.sampleRate * duration;
    const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
    const data = buffer.getChannelData(0);
    for (let i = 0; i < bufferSize; i++) {
      data[i] = (Math.random() * 2 - 1) * Math.pow(1 - i / bufferSize, 2);
    }
    const src = ctx.createBufferSource();
    src.buffer = buffer;

    // Bandpass filter for glass-like crack
    const filter = ctx.createBiquadFilter();
    filter.type = 'bandpass';
    filter.frequency.value = 3000 + Math.random() * 2000;
    filter.Q.value = 0.5;

    src.connect(filter);
    filter.connect(gain);
    src.start();

    // Add a sharp click
    const osc = ctx.createOscillator();
    const oGain = ctx.createGain();
    osc.type = 'square';
    osc.frequency.setValueAtTime(800 + Math.random() * 400, ctx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(100, ctx.currentTime + 0.05);
    oGain.gain.setValueAtTime(0.3 * intensity, ctx.currentTime);
    oGain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.05);
    osc.connect(oGain);
    oGain.connect(ctx.destination);
    osc.start();
    osc.stop(ctx.currentTime + 0.05);
  } catch(e) {}
}

function playShatterSound() {
  try {
    const ctx = getAudioCtx();
    for (let i = 0; i < 5; i++) {
      setTimeout(() => playCrackSound(0.5 + Math.random() * 0.5), i * 40);
    }
    // Deep bass thud
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.type = 'sine';
    osc.frequency.setValueAtTime(80, ctx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(20, ctx.currentTime + 0.3);
    gain.gain.setValueAtTime(1, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.3);
    osc.connect(gain);
    gain.connect(ctx.destination);
    osc.start();
    osc.stop(ctx.currentTime + 0.3);
  } catch(e) {}
}

function playBootSound() {
  try {
    const ctx = getAudioCtx();
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.type = 'sine';
    osc.frequency.setValueAtTime(440, ctx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(880, ctx.currentTime + 0.4);
    gain.gain.setValueAtTime(0.3, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.6);
    osc.connect(gain);
    gain.connect(ctx.destination);
    osc.start();
    osc.stop(ctx.currentTime + 0.6);
  } catch(e) {}
}

/* ============================================================
   HAPTIC ENGINE
============================================================ */
function vibrate(pattern) {
  if (navigator.vibrate) navigator.vibrate(pattern);
}
function hapticCrack() { vibrate([50, 10, 30]); }
function hapticShatter() { vibrate([100, 20, 80, 20, 60, 20, 40]); }
function hapticLight() { vibrate(20); }

/* ============================================================
   PARTICLE FIELD (launch screen)
============================================================ */
function createParticles() {
  const field = document.getElementById('particles');
  const colors = ['#00d4ff', '#b300ff', '#ff0080', '#00ff88', '#ffffff'];
  for (let i = 0; i < 25; i++) {
    const p = document.createElement('div');
    p.className = 'particle';
    const size = 2 + Math.random() * 4;
    const color = colors[Math.floor(Math.random() * colors.length)];
    p.style.cssText = `
      left: ${Math.random() * 100}%;
      width: ${size}px; height: ${size}px;
      background: ${color};
      box-shadow: 0 0 ${size * 2}px ${color};
      animation-duration: ${5 + Math.random() * 10}s;
      animation-delay: ${Math.random() * 10}s;
    `;
    field.appendChild(p);
  }
}
createParticles();

/* ============================================================
   CLOCK UPDATE
============================================================ */
function updateClocks() {
  const now = new Date();
  const h = String(now.getHours()).padStart(2, '0');
  const m = String(now.getMinutes()).padStart(2, '0');
  const s = String(now.getSeconds()).padStart(2, '0');
  const timeStr = `${h}:${m}`;
  const timeStrS = `${h}:${m}:${s}`;
  const days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
  const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
  const dateStr = `${days[now.getDay()]}, ${months[now.getMonth()]} ${now.getDate()}`;

  document.getElementById('status-time').textContent = timeStr;
  document.getElementById('lock-time').textContent = timeStr;
  document.getElementById('lock-date').textContent = dateStr;
  document.getElementById('crack-status-time').textContent = timeStr;
  document.getElementById('crack-lock-time').textContent = timeStr;
  document.getElementById('crack-lock-date').textContent = dateStr;
}
updateClocks();
setInterval(updateClocks, 1000);

/* ============================================================
   SCREEN MANAGEMENT
============================================================ */
let currentScreen = 'screen-launch';

function showScreen(id) {
  document.getElementById(currentScreen).classList.add('hidden');
  document.getElementById(id).classList.remove('hidden');
  currentScreen = id;
}

/* ============================================================
   COUNTDOWN LOGIC
============================================================ */
let prankCount = 0;

function startCountdown() {
  hapticLight();
  showScreen('screen-countdown');
  let count = 3;
  document.getElementById('countdown-num').textContent = count;

  const interval = setInterval(() => {
    count--;
    hapticLight();
    if (count <= 0) {
      clearInterval(interval);
      document.getElementById('countdown-num').textContent = 'GO!';
      document.getElementById('countdown-num').style.fontSize = 'clamp(80px, 25vw, 140px)';
      setTimeout(() => {
        showScreen('screen-home');
        document.getElementById('countdown-num').style.fontSize = '';
      }, 700);
    } else {
      document.getElementById('countdown-num').textContent = count;
    }
  }, 1000);
}

function goToCrackFromHome() {
  prankCount++;
  initCrackScreen();
  showScreen('screen-crack');
  // Show interstitial every 4 pranks
  if (prankCount % 4 === 0) {
    setTimeout(showInterstitial, 2000);
  }
}

function resetPrank() {
  clearCracks();
  showScreen('screen-launch');
  document.getElementById('crack-instructions').classList.remove('fade-out');
  pressHarderTimer = null;
  hidePresHarder();
}

/* ============================================================
   CRACK CANVAS ENGINE
============================================================ */
let crackCanvas, crackCtx;
let cracks = [];
let currentStyle = 0;
let tapCount = 0;
let instructionsFaded = false;

const crackStyles = [
  { primary: 'rgba(255,255,255,0.9)', secondary: 'rgba(255,255,255,0.4)', glow: 'rgba(255,255,255,0.6)', shardColor: 'rgba(200,220,255,0.6)' },
  { primary: 'rgba(0,255,136,0.9)', secondary: 'rgba(0,255,136,0.4)', glow: 'rgba(0,255,136,0.6)', shardColor: 'rgba(0,255,136,0.5)' },
  { primary: 'rgba(255,50,50,0.9)', secondary: 'rgba(200,0,0,0.5)', glow: 'rgba(255,0,0,0.6)', shardColor: 'rgba(255,80,80,0.5)' },
  { primary: 'rgba(255,0,200,0.9)', secondary: 'rgba(100,0,255,0.5)', glow: 'rgba(200,0,255,0.6)', shardColor: 'rgba(255,100,255,0.5)' },
];

function initCrackScreen() {
  crackCanvas = document.getElementById('crack-canvas');
  crackCtx = crackCanvas.getContext('2d');
  resizeCrackCanvas();
  cracks = [];
  renderCracks();
  tapCount = 0;
  instructionsFaded = false;
}

function resizeCrackCanvas() {
  crackCanvas.width = window.innerWidth;
  crackCanvas.height = window.innerHeight;
}

window.addEventListener('resize', () => {
  if (crackCanvas) resizeCrackCanvas();
});

function clearCracks() {
  cracks = [];
  if (crackCtx) crackCtx.clearRect(0, 0, crackCanvas.width, crackCanvas.height);
}

/* Generate a branching crack from a point */
function generateCrack(x, y, intensity = 1) {
  const numBranches = Math.floor(3 + Math.random() * 4 + intensity * 3);
  const cracksOut = [];

  for (let b = 0; b < numBranches; b++) {
    const angle = (Math.PI * 2 * b / numBranches) + (Math.random() - 0.5) * 0.8;
    const points = [{x, y}];
    let curX = x, curY = y;
    let curAngle = angle;
    const length = (80 + Math.random() * 120) * intensity;
    const numSegments = Math.floor(4 + Math.random() * 6);
    const segLength = length / numSegments;

    for (let s = 0; s < numSegments; s++) {
      curAngle += (Math.random() - 0.5) * 0.6;
      curX += Math.cos(curAngle) * segLength;
      curY += Math.sin(curAngle) * segLength;
      points.push({x: curX, y: curY});

      // Sub-branch
      if (Math.random() < 0.4 && s > 1) {
        const subAngle = curAngle + (Math.random() > 0.5 ? 0.4 : -0.4) + (Math.random() - 0.5) * 0.3;
        const subLen = segLength * (0.3 + Math.random() * 0.4);
        const subPoints = [{x: curX, y: curY}, {
          x: curX + Math.cos(subAngle) * subLen,
          y: curY + Math.sin(subAngle) * subLen
        }];
        cracksOut.push({ points: subPoints, alpha: 0, targetAlpha: 0.6 + Math.random() * 0.3 });
      }
    }
    cracksOut.push({ points, alpha: 0, targetAlpha: 0.8 + Math.random() * 0.2 });
  }

  // Impact circle
  cracksOut.push({ type: 'circle', x, y, radius: 4 + Math.random() * 4, alpha: 0, targetAlpha: 1 });

  cracks.push(...cracksOut);
}

function renderCracks() {
  if (!crackCtx) return;
  const style = crackStyles[currentStyle];
  crackCtx.clearRect(0, 0, crackCanvas.width, crackCanvas.height);

  // Animate alpha
  let needsUpdate = false;
  cracks.forEach(crack => {
    if (crack.alpha < crack.targetAlpha) {
      crack.alpha = Math.min(crack.alpha + 0.08, crack.targetAlpha);
      needsUpdate = true;
    }
  });

  cracks.forEach(crack => {
    if (crack.type === 'circle') {
      crackCtx.save();
      crackCtx.beginPath();
      crackCtx.arc(crack.x, crack.y, crack.radius, 0, Math.PI * 2);
      crackCtx.fillStyle = `rgba(255,255,255,${crack.alpha})`;
      crackCtx.shadowColor = style.glow;
      crackCtx.shadowBlur = 10;
      crackCtx.fill();
      crackCtx.restore();
      return;
    }

    if (!crack.points || crack.points.length < 2) return;

    // Draw glow layer
    crackCtx.save();
    crackCtx.beginPath();
    crackCtx.moveTo(crack.points[0].x, crack.points[0].y);
    for (let i = 1; i < crack.points.length; i++) {
      crackCtx.lineTo(crack.points[i].x, crack.points[i].y);
    }
    crackCtx.strokeStyle = style.glow.replace(')', `, ${crack.alpha * 0.5})`).replace('rgba(', 'rgba(');
    crackCtx.lineWidth = 4;
    crackCtx.shadowColor = style.glow;
    crackCtx.shadowBlur = 12;
    crackCtx.lineCap = 'round';
    crackCtx.stroke();

    // Draw main crack
    crackCtx.beginPath();
    crackCtx.moveTo(crack.points[0].x, crack.points[0].y);
    for (let i = 1; i < crack.points.length; i++) {
      crackCtx.lineTo(crack.points[i].x, crack.points[i].y);
    }
    crackCtx.strokeStyle = style.primary.replace(')', `, ${crack.alpha})`).replace('rgba(', 'rgba(');
    crackCtx.lineWidth = 1.5;
    crackCtx.shadowBlur = 0;
    crackCtx.stroke();

    crackCtx.restore();
  });

  // Add a dark vignette overlay as cracks build up
  const crackDensity = Math.min(cracks.length / 60, 1);
  if (crackDensity > 0.1) {
    const grad = crackCtx.createRadialGradient(
      crackCanvas.width/2, crackCanvas.height/2, crackCanvas.width * 0.1,
      crackCanvas.width/2, crackCanvas.height/2, crackCanvas.width * 0.8
    );
    grad.addColorStop(0, 'rgba(0,0,0,0)');
    grad.addColorStop(1, `rgba(0,0,0,${crackDensity * 0.4})`);
    crackCtx.fillStyle = grad;
    crackCtx.fillRect(0, 0, crackCanvas.width, crackCanvas.height);
  }

  if (needsUpdate) requestAnimationFrame(renderCracks);
}

/* Spawn glass shard particles */
function spawnShards(x, y, count = 6) {
  const screen = document.getElementById('screen-crack');
  const style = crackStyles[currentStyle];

  for (let i = 0; i < count; i++) {
    const shard = document.createElement('div');
    shard.className = 'glass-shard';
    const size = 4 + Math.random() * 12;
    const tx = (Math.random() - 0.5) * 160;
    const ty = 40 + Math.random() * 120;
    const rot = (Math.random() - 0.5) * 720;
    const dur = 0.5 + Math.random() * 0.5;

    // Create triangle/polygon shape via clip-path
    const shapes = [
      'polygon(50% 0%, 0% 100%, 100% 100%)',
      'polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)',
      'polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)'
    ];

    shard.style.cssText = `
      left: ${x}px; top: ${y}px;
      width: ${size}px; height: ${size}px;
      background: ${style.shardColor};
      clip-path: ${shapes[Math.floor(Math.random() * shapes.length)]};
      --tx: ${tx}px; --ty: ${ty}px; --rot: ${rot}deg; --dur: ${dur}s;
      box-shadow: 0 0 6px rgba(200,230,255,0.4);
      transform: translate(-50%, -50%);
      border: 1px solid rgba(255,255,255,0.3);
    `;
    screen.appendChild(shard);
    setTimeout(() => shard.remove(), dur * 1000 + 100);
  }
}

/* Add crack ripple visual */
function spawnRipple(x, y) {
  const screen = document.getElementById('screen-crack');
  const ripple = document.createElement('div');
  ripple.className = 'crack-ripple';
  ripple.style.cssText = `left: ${x}px; top: ${y}px;`;
  screen.appendChild(ripple);
  setTimeout(() => ripple.remove(), 700);
}

/* ============================================================
   TOUCH/CLICK EVENTS ON CRACK SCREEN
============================================================ */
let pressTimer = null;
let pressHarderTimer = null;
let lastTapTime = 0;
let longPressLevel = 0;

function hidePresHarder() {
  document.getElementById('press-harder').classList.remove('show');
}

document.getElementById('screen-crack').addEventListener('touchstart', handleCrackTouchStart, { passive: false });
document.getElementById('screen-crack').addEventListener('touchend', handleCrackTouchEnd, { passive: false });
document.getElementById('screen-crack').addEventListener('mousedown', (e) => {
  // ignore buttons
  if (e.target.classList.contains('btn-share') || e.target.classList.contains('btn-reset')) return;
  handleCrackTouchStart({ touches: [e], preventDefault: () => {} });
});
document.getElementById('screen-crack').addEventListener('mouseup', (e) => {
  handleCrackTouchEnd({ touches: [e] });
});

function handleCrackTouchStart(e) {
  e.preventDefault();
  const touch = e.touches[0];
  const x = touch.clientX;
  const y = touch.clientY;

  // Double tap detection
  const now = Date.now();
  if (now - lastTapTime < 350) {
    lastTapTime = 0;
    triggerReboot(x, y);
    return;
  }
  lastTapTime = now;

  // Long press for "press harder"
  pressTimer = setTimeout(() => {
    longPressLevel++;
    document.getElementById('press-harder').classList.add('show');
    generateCrack(x, y, 0.5 + longPressLevel * 0.3);
    playCrackSound(0.5 + longPressLevel * 0.2);
    hapticCrack();
    renderCracks();
    spawnShards(x, y, 3 + longPressLevel);
    pressHarderTimer = setInterval(() => {
      generateCrack(x + (Math.random()-0.5)*40, y + (Math.random()-0.5)*40, 0.4);
      renderCracks();
      playCrackSound(0.3);
      hapticLight();
    }, 300);
  }, 400);

  // Fade instructions after first tap
  if (!instructionsFaded) {
    instructionsFaded = true;
    setTimeout(() => {
      document.getElementById('crack-instructions').classList.add('fade-out');
    }, 1500);
  }
}

function handleCrackTouchEnd(e) {
  clearTimeout(pressTimer);
  if (pressHarderTimer) { clearInterval(pressHarderTimer); pressHarderTimer = null; }
  hidePresHarder();
  longPressLevel = 0;

  const touch = e.changedTouches ? e.changedTouches[0] : (e.touches && e.touches[0]);
  if (!touch) return;

  const x = touch.clientX;
  const y = touch.clientY;
  tapCount++;

  generateCrack(x, y, 0.8 + Math.min(tapCount * 0.05, 0.8));
  playCrackSound(0.7 + Math.random() * 0.3);
  hapticCrack();
  renderCracks();
  spawnShards(x, y, 5);
  spawnRipple(x, y);

  // Progressive damage to background
  const crackIntensity = Math.min(tapCount / 15, 1);
  const bg = document.getElementById('crack-bg');
  bg.style.filter = `blur(${crackIntensity * 3}px) brightness(${1 - crackIntensity * 0.4})`;
}

/* ============================================================
   SHAKE TO SHATTER
============================================================ */
let lastShake = 0;
let shakeThreshold = 18;

function handleMotion(event) {
  const acc = event.accelerationIncludingGravity;
  if (!acc) return;
  const now = Date.now();
  const magnitude = Math.sqrt(acc.x * acc.x + acc.y * acc.y + acc.z * acc.z);

  if (magnitude > shakeThreshold && now - lastShake > 1200 && currentScreen === 'screen-crack') {
    lastShake = now;
    triggerMassiveShatter();
  }
}

window.addEventListener('devicemotion', handleMotion, { passive: true });

function triggerMassiveShatter() {
  playShatterSound();
  hapticShatter();

  // Flash
  const flash = document.getElementById('flash-overlay');
  flash.classList.add('flash');
  setTimeout(() => flash.classList.remove('flash'), 400);

  // Screen shake
  document.getElementById('screen-crack').classList.add('shake');
  setTimeout(() => document.getElementById('screen-crack').classList.remove('shake'), 600);

  // Massive cracks everywhere
  const w = window.innerWidth;
  const h = window.innerHeight;
  const impactPoints = 5 + Math.floor(Math.random() * 4);
  for (let i = 0; i < impactPoints; i++) {
    setTimeout(() => {
      const x = 0.1 * w + Math.random() * 0.8 * w;
      const y = 0.1 * h + Math.random() * 0.8 * h;
      generateCrack(x, y, 2);
      spawnShards(x, y, 12);
      spawnRipple(x, y);
    }, i * 80);
  }
  setTimeout(renderCracks, 0);

  // Max distort bg
  document.getElementById('crack-bg').style.filter = 'blur(4px) brightness(0.3) saturate(0.5)';
}

/* ============================================================
   DOUBLE TAP REBOOT
============================================================ */
function triggerReboot(x, y) {
  hapticShatter();
  playBootSound();

  // Screen fade out with flash
  const flash = document.getElementById('flash-overlay');
  flash.style.transition = 'none';
  flash.style.opacity = 1;
  showScreen('screen-boot');

  setTimeout(() => {
    flash.style.transition = 'opacity 1s ease';
    flash.style.opacity = 0;
    // Reset boot bar
    const bar = document.getElementById('boot-bar');
    bar.style.animation = 'none';
    void bar.offsetWidth;
    bar.style.animation = 'boot-progress 2.5s ease-in-out forwards';
  }, 100);

  setTimeout(() => {
    // Back to cracked screen ‚Äî restore cracks
    showScreen('screen-crack');
  }, 3200);
}

/* ============================================================
   MODAL
============================================================ */
function openModal() {
  document.getElementById('modal-styles').classList.add('show');
}
function closeModal() {
  document.getElementById('modal-styles').classList.remove('show');
}
function handleModalClick(e) {
  if (e.target === document.getElementById('modal-styles')) closeModal();
}
function selectStyle(index, el) {
  document.querySelectorAll('.crack-style-card').forEach(c => c.classList.remove('active'));
  el.classList.add('active');
  currentStyle = index;
  clearCracks();
  closeModal();
}
function purchaseAll() {
  alert('Purchase flow would connect to RevenueCat SDK in production!\n\nProduct: com.crackscreen.premium_pack\nPrice: $2.99');
}
function purchaseNoAds() {
  alert('Purchase flow would connect to RevenueCat SDK in production!\n\nProduct: com.crackscreen.no_ads\nPrice: $1.99');
}
function showSettings() {
  alert('Settings: Vibration intensity, default crack style, prank timer duration.');
}

/* ============================================================
   SHARE
============================================================ */
function showShare() {
  document.getElementById('share-overlay').classList.add('show');
}
function hideShare() {
  document.getElementById('share-overlay').classList.remove('show');
}
async function nativeShare() {
  if (navigator.share) {
    try {
      await navigator.share({
        title: 'CrackScreen Prank üí•',
        text: 'My friend literally broke my phone!! üò± Check out the best prank app of 2026!',
        url: window.location.href
      });
    } catch(e) {}
  } else {
    copyLink();
  }
}
function copyLink() {
  navigator.clipboard.writeText(window.location.href).then(() => {
    alert('Link copied! Share it with your friends üéâ');
  }).catch(() => {
    alert('Share link: ' + window.location.href);
  });
}

/* ============================================================
   INTERSTITIAL
============================================================ */
let interSkipCount = 5;
let interTimer = null;

function showInterstitial() {
  document.getElementById('interstitial').classList.add('show');
  const skipBtn = document.getElementById('inter-skip');
  interSkipCount = 5;
  skipBtn.textContent = `Skip (${interSkipCount})`;
  skipBtn.disabled = true;

  interTimer = setInterval(() => {
    interSkipCount--;
    if (interSkipCount <= 0) {
      clearInterval(interTimer);
      skipBtn.textContent = 'Skip';
      skipBtn.disabled = false;
    } else {
      skipBtn.textContent = `Skip (${interSkipCount})`;
    }
  }, 1000);
}

function closeInterstitial() {
  if (interSkipCount > 0) return;
  clearInterval(interTimer);
  document.getElementById('interstitial').classList.remove('show');
}

/* ============================================================
   PWA ‚Äî Service Worker + Manifest
============================================================ */
const manifestData = {
  name: "CrackScreen ‚Äì Fake Broken Screen Prank",
  short_name: "CrackScreen",
  description: "The most realistic broken screen prank app of 2026",
  start_url: "./",
  display: "fullscreen",
  orientation: "portrait",
  background_color: "#000000",
  theme_color: "#000000",
  icons: [
    { src: "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 192'><rect width='192' height='192' rx='40' fill='%23050508'/><text y='130' x='96' text-anchor='middle' font-size='120'>üí•</text></svg>", sizes: "192x192", type: "image/svg+xml" },
    { src: "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><rect width='512' height='512' rx='100' fill='%23050508'/><text y='360' x='256' text-anchor='middle' font-size='320'>üí•</text></svg>", sizes: "512x512", type: "image/svg+xml" }
  ]
};

const manifestBlob = new Blob([JSON.stringify(manifestData)], { type: 'application/json' });
const manifestURL = URL.createObjectURL(manifestBlob);
document.getElementById('manifest-link').href = manifestURL;

// Service Worker
if ('serviceWorker' in navigator) {
  const swCode = `
    const CACHE_NAME = 'crackscreen-v1';
    self.addEventListener('install', e => {
      e.waitUntil(caches.open(CACHE_NAME).then(cache => cache.add('/')));
      self.skipWaiting();
    });
    self.addEventListener('activate', e => {
      e.waitUntil(clients.claim());
    });
    self.addEventListener('fetch', e => {
      e.respondWith(
        caches.match(e.request).then(r => r || fetch(e.request).then(res => {
          const copy = res.clone();
          caches.open(CACHE_NAME).then(cache => cache.put(e.request, copy));
          return res;
        }).catch(() => caches.match('/')))
      );
    });
  `;
  const swBlob = new Blob([swCode], { type: 'application/javascript' });
  const swURL = URL.createObjectURL(swBlob);
  navigator.serviceWorker.register(swURL).catch(() => {});
}

// PWA install
let deferredInstallPrompt = null;
window.addEventListener('beforeinstallprompt', e => {
  e.preventDefault();
  deferredInstallPrompt = e;
  document.getElementById('install-btn').style.display = '';
});

function installPWA() {
  if (deferredInstallPrompt) {
    deferredInstallPrompt.prompt();
    deferredInstallPrompt.userChoice.then(() => {
      deferredInstallPrompt = null;
      document.getElementById('install-btn').style.display = 'none';
    });
  }
}

/* ============================================================
   DeviceOrientation ‚Äî parallax on cracks
============================================================ */
let targetTiltX = 0, targetTiltY = 0;
let currentTiltX = 0, currentTiltY = 0;

window.addEventListener('deviceorientation', (e) => {
  if (currentScreen !== 'screen-crack') return;
  targetTiltX = (e.gamma || 0) / 30; // -1 to 1
  targetTiltY = (e.beta || 45) / 30 - 1; // normalized
}, { passive: true });

function animateParallax() {
  currentTiltX += (targetTiltX - currentTiltX) * 0.1;
  currentTiltY += (targetTiltY - currentTiltY) * 0.1;
  if (crackCanvas && Math.abs(currentTiltX) > 0.001) {
    crackCanvas.style.transform = `translate(${currentTiltX * 8}px, ${currentTiltY * 6}px) perspective(800px) rotateX(${currentTiltY * 3}deg) rotateY(${currentTiltX * 3}deg)`;
  }
  requestAnimationFrame(animateParallax);
}
animateParallax();

/* ============================================================
   REQUEST DEVICE MOTION PERMISSIONS (iOS 13+)
============================================================ */
document.getElementById('btn-start').addEventListener('touchend', async () => {
  if (typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === 'function') {
    try {
      await DeviceMotionEvent.requestPermission();
    } catch(e) {}
  }
  if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
    try {
      await DeviceOrientationEvent.requestPermission();
    } catch(e) {}
  }
});
</script>
</body>
</html>
